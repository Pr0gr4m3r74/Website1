<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Mini-Game — Schach</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.css" />
<link rel="stylesheet" href="chess.css" />
</head>
<body>
<header>
  <h1>Schach</h1>
  <nav>
    <a href="index.html">Start</a>
    <a href="minigames.html" aria-current="page">Mini-Games</a>
    <a href="projects.html">Projekte</a>
    <a href="kontakt.html">Kontakt</a>
    <a href="impressum.html">Impressum</a>
  </nav>
</header>

<main>
  <h2>Spiele gegen einen einfachen Computergegner</h2>
  <div class="board-wrap">
    <div id="board"></div>
    <div class="controls">
      <div class="status" id="status">Status: Bereit</div>
      <button id="newGameBtn">Neues Spiel</button>
      <button id="undoBtn">Rückgängig</button>
      <label class="status">Difficulty: Einfach (Zufallszüge)</label>
      <div class="moves" id="moves">Züge: —</div>
    </div>
  </div>
</main>

<footer>© 2026 IT Solutions</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/1.0.0/chess.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/chessboard-js/1.0.0/chessboard-1.0.0.min.js"></script>
<script>
// Simple Chess page: uses chess.js for rules and chessboard.js for UI
const game = new Chess();
let board = null;
let $status = document.getElementById('status');
let $moves = document.getElementById('moves');
const whiteIsHuman = true; // human plays white by default

function updateStatus(){
  let status = '';
  const turn = game.turn() === 'w' ? 'Weiß' : 'Schwarz';
  if (game.in_checkmate()){
    status = 'Schachmatt — ' + (turn === 'Weiß' ? 'Schwarz' : 'Weiß') + ' hat gewonnen.';
  } else if (game.in_draw()){
    status = 'Unentschieden.';
  } else {
    status = 'Am Zug: ' + turn + (game.in_check() ? ' (Schach!)' : '');
  }
  $status.textContent = 'Status: ' + status;
  $moves.innerHTML = '<strong>Alle Züge</strong><br>' + game.pgn();
}

function onDragStart(source, piece, position, orientation){
  // do not pick up pieces if the game is over
  if (game.game_over()) return false;
  // only pick up pieces for the side to move (white human)
  if ((game.turn() === 'w' && piece.search(/^b/) !== -1) || (game.turn() === 'b' && piece.search(/^w/) !== -1)){
    // if it's AI turn, prevent drag
    return false;
  }
}

function onDrop(source, target){
  // see if the move is legal
  const move = game.move({ from: source, to: target, promotion: 'q' });
  if (move === null) return 'snapback';
  updateStatus();
  window.setTimeout(function(){
    if (!game.game_over()) makeAIMove();
  }, 250);
}

function onSnapEnd(){
  board.position(game.fen());
}

function makeAIMove(){
  // very simple AI: choose a random legal move
  const moves = game.moves();
  if (moves.length === 0) return;
  const move = moves[Math.floor(Math.random()*moves.length)];
  game.move(move);
  board.position(game.fen());
  updateStatus();
}

const cfg = {
  draggable: true,
  position: 'start',
  onDragStart: onDragStart,
  onDrop: onDrop,
  onSnapEnd: onSnapEnd
};

board = Chessboard('board', cfg);
updateStatus();

// Controls
document.getElementById('newGameBtn').addEventListener('click', ()=>{
  game.reset();
  board.start();
  updateStatus();
});

document.getElementById('undoBtn').addEventListener('click', ()=>{
  game.undo();
  game.undo(); // undo both human and AI move if possible
  board.position(game.fen());
  updateStatus();
});
</script>
</body>
</html>
