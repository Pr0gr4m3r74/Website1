<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Karten-Mini-Game</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* ===== Spielbereich ===== */
    .game-area { text-align: center; margin-left: 240px; }

    /* GroÃŸe Karte */
    .card {
      width: 180px;
      height: 280px;
      border-radius: 16px;
      padding: 12px;
      margin: 20px auto;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      font-weight: bold;
      color: #fff;
      text-align: center;
      position: relative;
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
      overflow: hidden;
      border: 4px solid transparent;
      transition: transform 0.2s ease;
    }
    .icon { font-size: 64px; margin: 12px 0; }
    .stars { margin-top: 4px; }

    /* Inventar */
    .inventory {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 16px;
      margin-top: 30px;
    }
    .small-card {
      border-radius: 12px;
      padding: 8px;
      font-size: 12px;
      text-align: center;
      height: 140px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      overflow: hidden;
      border: 3px solid transparent;
    }

    /* Seltenheit Farben & Verzierung */
    .common { background: linear-gradient(135deg, #6b7280, #4b5563, #9ca3af); border-image: linear-gradient(45deg, #a3e635, #22d3ee) 1; border-radius: 16px; }
    .rare { background: linear-gradient(135deg, #2563eb, #1e40af, #3b82f6); border-image: linear-gradient(45deg, #60a5fa, #3b82f6) 1; box-shadow: 0 0 12px #3b82f6 inset; }
    .epic { background: linear-gradient(135deg, #7c3aed, #5b21b6, #c084fc); border-image: linear-gradient(45deg, #d8b4fe, #a78bfa) 1; box-shadow: 0 0 15px #c084fc inset; }
    .legendary { background: linear-gradient(135deg, #f59e0b, #b45309, #fbbf24); border-image: linear-gradient(45deg, #fde68a, #f97316) 1; box-shadow: 0 0 18px #f59e0b inset; }
    .mythic { background: linear-gradient(135deg, #dc2626, #7f1d1d, #f87171); border-image: linear-gradient(45deg, #fca5a5, #b91c1c) 1; box-shadow: 0 0 25px #dc2626 inset, 0 0 15px #f87171; }

    /* Hover Effekt */
    .card:hover, .small-card:hover { transform: translateY(-6px) scale(1.03); transition: transform 0.2s ease; }

    /* ===== Altar ===== */
    #altar {
      position: fixed;
      left: 20px;
      top: 100px;
      width: 200px;
      background: #1e293b;
      padding: 12px;
      border-radius: 12px;
      color: #fff;
    }
    .altar-slot {
      height: 60px;
      margin-bottom: 8px;
      border: 2px dashed #94a3b8;
      border-radius: 8px;
    }
  </style>
</head>
<body>
<header>
  <h1>Karten ziehen</h1>
  <nav>
    <a href="index.html">Start</a>
    <a href="minigame.html">Mini-Game</a>
    <a href="kontakt.html">Kontakt</a>
    <a href="impressum.html">Impressum</a>
  </nav>
</header>

<!-- Altar links -->
<div id="altar">
  <h3>Altar</h3>
  <p>Ziehe 3 Karten gleichen Typs hier, um eine hÃ¶here Seltenheit zu erhalten</p>
  <div id="altar-slots">
    <div class="altar-slot" data-index="0"></div>
    <div class="altar-slot" data-index="1"></div>
    <div class="altar-slot" data-index="2"></div>
  </div>
  <button onclick="summonFromAltar()">Opfern & Belohnung</button>
  <div id="altar-result"></div>
</div>

<main class="game-area">
  <button onclick="drawCard()">Karte ziehen</button>
  <div id="currentCard"></div>
  <h2>Inventar</h2>
  <div id="inventory" class="inventory"></div>
</main>

<footer>Â© 2026 IT Solutions</footer>

<script>
const rarities = [
  { name: 'GewÃ¶hnlich', chance: 70 },
  { name: 'Selten', chance: 20 },
  { name: 'Episch', chance: 8 },
  { name: 'LegendÃ¤r', chance: 1.99 },
  { name: 'Mythisch', chance: 0.01 }
];

const allCards = [
  { name: 'Erd-Essenz', icon: 'â¬›', rarity: 'GewÃ¶hnlich' },
  { name: 'Holz-Essenz', icon: 'ğŸŸ«', rarity: 'GewÃ¶hnlich' },
  { name: 'Wasser-Essenz', icon: 'ğŸ’§', rarity: 'GewÃ¶hnlich' },
  { name: 'Wind-Essenz', icon: 'ğŸŒ«ï¸', rarity: 'GewÃ¶hnlich' },
  { name: 'Licht-Funke', icon: 'âœ¨', rarity: 'GewÃ¶hnlich' },
  { name: 'Schatten-Rest', icon: 'ğŸŒ‘', rarity: 'GewÃ¶hnlich' },
  { name: 'Asche-Partikel', icon: 'ğŸŸ¤', rarity: 'GewÃ¶hnlich' },
  { name: 'Kristall-Essenz', icon: 'ğŸ”·', rarity: 'Selten' },
  { name: 'Energie-Kern', icon: 'ğŸ”‹', rarity: 'Selten' },
  { name: 'Flammenkern', icon: 'ğŸ”¥', rarity: 'Selten' },
  { name: 'Frostkern', icon: 'â„ï¸', rarity: 'Selten' },
  { name: 'Gold-Matrix', icon: 'ğŸŸ¨', rarity: 'Episch' },
  { name: 'Astral-Kern', icon: 'ğŸŒŒ', rarity: 'Episch' },
  { name: 'Zeit-Fragment', icon: 'â³', rarity: 'Episch' },
  { name: 'Lichtkristall', icon: 'ğŸ’', rarity: 'Episch' },
  { name: 'Klinge der Ordnung', icon: 'ğŸ—¡ï¸', rarity: 'LegendÃ¤r' },
  { name: 'Bogen der Weite', icon: 'ğŸ¹', rarity: 'LegendÃ¤r' },
  { name: 'Siegel der Macht', icon: 'ğŸ”±', rarity: 'LegendÃ¤r' },
  { name: 'Krone der Herrschaft', icon: 'ğŸ‘‘', rarity: 'LegendÃ¤r' },
  { name: 'SingularitÃ¤t', icon: 'âš«', rarity: 'Mythisch' },
  { name: 'Paradox', icon: 'âšª', rarity: 'Mythisch' }
];

let inventory = [];
let altarSlots = [null, null, null];

function weightedRandom() {
  let roll = Math.random() * 100;
  let sum = 0;
  for (let r of rarities) {
    sum += r.chance;
    if (roll <= sum) return r.name;
  }
}

function drawCard() {
  let rarity = weightedRandom();
  let cardsOfRarity = allCards.filter(c => c.rarity === rarity);
  let card = {...cardsOfRarity[Math.floor(Math.random() * cardsOfRarity.length)]};
  let qRoll = Math.random() * 100;
  if (qRoll <= 50) card.quality = 1 + Math.floor(Math.random() * 2);
  else if (qRoll <= 80) card.quality = 3;
  else if (qRoll <= 95) card.quality = 4;
  else card.quality = 5;
  inventory.push(card);
  showCurrentCard(card);
  renderInventory();
  makeDraggable();
}

function showCurrentCard(card) {
  const div = document.getElementById('currentCard');
  let stars = 'âœ¦'.repeat(card.quality);
  div.innerHTML = `<div class="card ${card.rarity.toLowerCase()}"><div class="rarity">${card.rarity}</div><div class="name">${card.name}</div><div class="icon">${card.icon}</div><div class="stars">${stars}</div></div>`;
}

function renderInventory() {
  const inv = document.getElementById('inventory');
  inv.innerHTML = '';
  inventory.forEach(c => {
    const d = document.createElement('div');
    d.className = `small-card ${c.rarity.toLowerCase()}`;
    let stars = 'âœ¦'.repeat(c.quality);
    d.innerHTML = `<div class="icon">${c.icon}</div><div class="name">${c.name}</div><div class="stars">${stars}</div>`;
    inv.appendChild(d);
  });
}

function makeDraggable() {
  const cards = document.querySelectorAll('.small-card');
  cards.forEach(card => {
    card.setAttribute('draggable', true);
    card.ondragstart = e => {
      e.dataTransfer.setData('text/plain', inventory.indexOf(getCardFromElement(card)));
      card.classList.add('dragging');
    };
    card.ondragend = e => { card.classList.remove('dragging'); };
  });
  const inv = document.getElementById('inventory');
  inv.ondragover = e => {
    e.preventDefault();
    const afterElement = getDragAfterElement(inv, e.clientY);
    const dragging = document.querySelector('.dragging');
    if (afterElement == null) inv.appendChild(dragging);
    else inv.insertBefore(dragging, afterElement);
  };
}

function getCardFromElement(el) {
  const index = Array.from(document.getElementById('inventory').children).indexOf(el);
  return inventory[index];
}

function getDragAfterElement(container, y) {
  const draggableElements = [...container.querySelectorAll('.small-card:not(.dragging)')];
  return draggableElements.reduce((closest, child) => {
    const box = child.getBoundingClientRect();
    const offset = y - box.top - box.height / 2;
    if (offset < 0 && offset > closest.offset) return { offset: offset, element: child };
    else return closest;
  }, { offset: Number.NEGATIVE_INFINITY }).element;
}

function renderAltar() {
  const slots = document.querySelectorAll('.altar-slot');
  for (let i = 0; i < 3; i++) {
    if (altarSlots[i]) slots[i].textContent = altarSlots[i].name + ' (' + altarSlots[i].rarity + ')';
    else slots[i].textContent = '';
  }
}

function summonFromAltar() {
  if (altarSlots.some(s => !s)) { alert('Alle 3 Slots mÃ¼ssen gefÃ¼llt sein!'); return; }
  const type = altarSlots[0].rarity;
  if (!altarSlots.every(c => c.rarity === type)) { alert('Alle 3 Karten mÃ¼ssen dieselbe Seltenheit haben!'); return; }
  const raritiesOrder = ['GewÃ¶hnlich','Selten','Episch','LegendÃ¤r','Mythisch'];
  let currentIndex = raritiesOrder.indexOf(type);
  if (currentIndex === raritiesOrder.length - 1) { alert('Maximale Seltenheit erreicht!'); return; }
  const higherRarity = raritiesOrder[currentIndex + 1];
  const possibleCards = allCards.filter(c => c.rarity === higherRarity);
  const reward = {...possibleCards[Math.floor(Math.random() * possibleCards.length)]};
  inventory.push(reward);
  altarSlots = [null, null, null];
  renderInventory(); renderAltar();
  document.getElementById('altar-result').textContent = 'Du erhÃ¤ltst: ' + reward.name + ' (' + reward.rarity + ')';
}
</script>

</body>
</html>
